
## `alignment-lastz`

Scripts that use the output of a LASTZ alignment (this work uses an HSP threshold of
30k) between the mt alleles to create FASTA files for downstream analysis.

From the LASTZ alignment, both `.maf` and `general` (referred to as `bed`) files
are generated. These contain equivalent data encoded different ways. 
The `maf` file has information about where gaps are in the alignment, while
the `general` file is easier to parse for other purposes. 

### Filtering alignments - `clean_lastz_output.R`

This script filters a `general` formatted LASTZ output file
to resolve overlapping alignments by only keeping the alignment with
the highest score.

### Creating aligned FASTA files - `align_mt_fasta_maf.py`

This script uses a `.maf` formatted LASTZ output file alongside
the filtered `general` file generated by `clean_lastz_output.R` to
create a directory of FASTA alignments across both mating types. Each file 
in the directory represents a single alignment in the LASTZ output.

### Combining the FASTAs into a single 'master' alignment

This task involves three scripts.

`transpose_fastas.py` transposes the generated alignments into a
'long' format, with positions as keys and nucleotides as values.
This allows all the alignments to be combined into one file.

`remove_duplicates.R` reduces the overlap between some alignments
to a single instance of each positions.

`combine_fastas.py` converts the filtered, transposed sequence file
back into FASTA format. The alignment is as long as the entire mt+ locus,
and non-aligned (ie non shared) regions are filled in with Ns.

### Appending the C domain - `append_c_domain.py`

The C domain of MT is completely syntenic across both alleles, and can
be pulled directly from chromosome_6:826738-943474 for all strains.
This script will take in the FASTA generated by `combine_fastas.py` above
and combine it with a FASTA containing the C domain.

### Creating non-shared files for the mt alleles - `make_mt_only.py`

This script uses the LASTZ alignment to create FASTA files with the
_shared_ regions masked. It is effectively the inverse of the
file created by `combine_fastas.py` above. 
